<div class="change-password-container">
  <div class="change-password-form">
    <h2 class="change-password-title">{{ isForced ? 'Changement de mot de passe obligatoire' : 'Nouveau mot de passe' }}</h2>
    
    <div *ngIf="isForced" style="margin-bottom: 16px; padding: 12px; background-color: #fff7e6; border: 1px solid #ffd591; border-radius: 4px;">
      <p style="margin: 0; color: #d46b08;">
        <strong>Attention</strong><br>
        Vous devez définir un nouveau mot de passe pour continuer à utiliser votre compte.
      </p>
    </div>

    <div style="margin-bottom: 16px; padding: 12px; background-color: #f0f0f0; border-radius: 4px;">
      <p style="margin: 0;">Email : <strong>{{ email }}</strong></p>
    </div>

    <form
      nz-form
      [formGroup]="form"
      (ngSubmit)="submitForm()"
    >
      <nz-form-item>
        <nz-form-control [nzErrorTip]="'Le mot de passe doit contenir au moins 6 caractères !'">
          <nz-input-group nzPrefixIcon="lock">
            <input
              type="password"
              nz-input
              formControlName="newPassword"
              placeholder="Nouveau mot de passe"
            />
          </nz-input-group>
        </nz-form-control>
      </nz-form-item>

      <nz-form-item>
        <nz-form-control [nzErrorTip]="form.get('confirmPassword')?.hasError('passwordMismatch') ? 'Les mots de passe ne correspondent pas !' : 'Veuillez confirmer votre mot de passe !'">
          <nz-input-group nzPrefixIcon="lock">
            <input
              type="password"
              nz-input
              formControlName="confirmPassword"
              placeholder="Confirmer le mot de passe"
            />
          </nz-input-group>
        </nz-form-control>
      </nz-form-item>

      <div *ngIf="errorMessage" style="color: red; margin-bottom: 12px">
        {{ errorMessage }}
      </div>

      <button
        nz-button
        class="change-password-button"
        [nzType]="'primary'"
        [disabled]="loading"
        [nzLoading]="loading"
        nzBlock
      >
        {{ isForced ? 'Changer le mot de passe' : 'Réinitialiser le mot de passe' }}
      </button>

      <div *ngIf="!isForced" style="text-align: center; margin-top: 16px;">
        <a (click)="goBack()">Retour</a>
      </div>
    </form>
  </div>
</div>

